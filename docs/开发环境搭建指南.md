# 开发环境搭建指南

本指南汇总了在本地快速拉起 SoulBrowser 所需的依赖、脚本与常见操作。不同小节可以单独执行，方便按需查阅。

## 同步 soul-base

`soul-base` 仍然托管在私有仓库，但仓库中自带了一个固定版本的镜像（`third_party/soul-base/`）。克隆完成后即可直接构建，无需额外的子模块步骤。如果需要刷新镜像，可将内网只读仓库路径写入 `SOULBASE_SOURCE` 并运行同步脚本：

```bash
SOULBASE_SOURCE=/data/repos/soul-base ./scripts/sync-soulbase.sh
```

脚本会把 `third_party/soul-base` 目录与指定源保持一致（包含删除、更新），记得在提交前检查 diff 以确认版本变更是否符合预期。

完成同步后，可通过构建若干 `soulbase-*` crate 来验证 API 是否匹配：

```bash
cargo build -p soulbase-types -p soulbase-tools -p soulbase-auth
```

上述命令会在 `third_party/soul-base` 目录直接编译镜像内的 crate，一旦出现编译错误通常意味着主仓库和私有依赖存在版本漂移，需要重新拉取镜像或切换到 CI 使用的标签。

## 标准检查

完成依赖同步后，可执行下面的例行检查来确保开发环境可用：

```bash
cargo fmt --all -- --check
cargo clippy --workspace --all-targets -- -D warnings
cargo test --workspace --all-features
```

如需验证不依赖 soul-base 的最小运行时，可执行：

```bash
cargo build -p soulbrowser-kernel --no-default-features
```

该目标会使用内置的 stub，实现外部 contributor 也能在未接入私有仓库的情况下贡献代码。
